#!/bin/bash

#####  TASK 1
# Define the line to add
line_to_add="enforce_for_root"

# Check if the line already exists in the file
if grep -q "^$line_to_add" /etc/security/pwhistory.conf; then
  echo "The line '$line_to_add' already exists in /etc/security/pwhistory.conf."
else
  # Add the line to the file
  echo "$line_to_add" | sudo tee -a /etc/security/pwhistory.conf > /dev/null
  echo "The line '$line_to_add' has been added to /etc/security/pwhistory.conf."
fi

#####  TASK 2
# Set the default inactive period for new users to 45 days
useradd -D -f 45

# Check if the command was successful
if [ $? -eq 0 ]; then
  echo "Default inactive period set to 45 days successfully."
else
  echo "Failed to set the default inactive period."
  exit 1
fi

#####  TASK 3
# Define the line to add or update
config_line="remember = 24"
config_file="/etc/security/pwhistory.conf"

# Check if the line is already present in the file
if grep -q "^\s*remember\s*=" "$config_file"; then
  # If the line is present, update it
  sudo sed -i "s/^\s*remember\s*=.*/$config_line/" "$config_file"
  echo "Updated existing 'remember' setting to '$config_line'."
else
  # If the line is not present, add it
  echo "$config_line" | sudo tee -a "$config_file" > /dev/null
  echo "Added new 'remember' setting: '$config_line'."
fi
